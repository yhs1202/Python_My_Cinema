<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>배우 검색 - My Cinema</title>
    <style>
        body {
            text-align: center;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(180deg, #0d0d1a, #050509);
            color: #e0e0e0;
            margin: 0;
            padding: 0 20px;
        }
        .header {
            padding: 40px 0;
        }
        .header h1 {
            font-size: 48px;
            color: #d4af37;
            text-shadow: 0 0 8px rgba(212, 175, 55, 0.6);
            margin: 0;
            cursor: pointer;
        }
        .search-container {
            max-width: 800px;
            margin: 0 auto 40px auto;
            background-color: #1a1a1a;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.7);
        }
        .search-box {
            display: flex;
            gap: 15px;
        }
        .search-box input[type="text"] {
            flex-grow: 1;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #333;
            border-radius: 8px;
            background-color: #2c2c2c;
            color: #e0e0e0;
            outline: none;
            transition: border-color 0.3s ease;
        }
        .search-box input[type="text"]:focus {
            border-color: #d4af37;
        }
        .search-box button {
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            color: #0d0d1a;
            background-color: #d4af37;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .search-box button:hover {
            background-color: #b89a31;
        }
        .filter-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        .filter-container select {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #333;
            background-color: #2c2c2c;
            color: #e0e0e0;
            font-size: 14px;
        }
        .results-container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 30px;
            padding-bottom: 60px;
        }
        .actor-card-link {
            text-decoration: none; /* 링크 밑줄 제거 */
        }
        .actor-card {
            background-color: #1c1c1c;
            border-radius: 12px;
            overflow: hidden;
            text-align: left;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .actor-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.4);
        }
        .actor-card img {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
        .actor-info {
            padding: 15px;
        }
        .actor-info h3 {
            margin: 0 0 5px 0;
            color: #d4af37;
            font-size: 18px;
        }
        .actor-info p {
            margin: 0;
            color: #a0a0a0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 onclick="location.href='/'">영화인 찾기</h1>
    </div>

    <div class="search-container">
        <div class="search-box">
            <input type="text" id="actorName" placeholder="배우 이름을 입력하세요...">
            <button onclick="searchActor()">검색</button>
        </div>
        <div class="filter-container">
            <select id="genreFilter">
                <option value="">장르 선택</option>
                <option value="28">액션</option>
                <option value="35">코미디</option>
                <option value="18">드라마</option>
                <option value="53">스릴러</option>
            </select>
            <select id="genderFilter">
                <option value="">성별 선택</option>
                <option value="2">남성</option>
                <option value="1">여성</option>
            </select>
            <select id="ageFilter">
                <option value="">나이대 선택</option>
                <option value="10s">10대</option>
                <option value="20s">20대</option>
                <option value="30s">30대</option>
                <option value="40s">40대</option>
                <option value="50s_over">50대 이상</option>
            </select>
            <select id="debutYearFilter">
                <option value="">데뷔 연도</option>
                <option value="2020s">2020년대</option>
                <option value="2010s">2010년대</option>
                <option value="2000s">2000년대</option>
                <option value="1990s">1990년대</option>
                <option value="pre_1990s">1990년대 이전</option>
            </select>
        </div>
    </div>

    <div class="results-container" id="results">
        </div>

    <script>
        async function searchActor() {
            const actorName = document.getElementById('actorName').value;
            const gender = document.getElementById('genderFilter').value;
            const age = document.getElementById('ageFilter').value;
            const debut = document.getElementById('debutYearFilter').value;
            const genre = document.getElementById('genreFilter').value;
            
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '<h2>검색 중...</h2>';

            const query = new URLSearchParams({
                name: actorName,
                gender: gender,
                age: age,
                debut: debut,
                genre: genre
            }).toString();

            try {
                const response = await fetch(`/api/search-actors?${query}`);
                if (!response.ok) {
                    throw new Error('서버에서 응답을 받지 못했습니다.');
                }
                const actors = await response.json();
                displayResults(actors);
            } catch (error) {
                console.error('검색 중 오류 발생:', error);
                resultsContainer.innerHTML = '<h2>검색 중 오류가 발생했습니다.</h2>';
            }
        }

        function displayResults(actors) {
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '';

            if (actors.length === 0) {
                resultsContainer.innerHTML = '<h2>검색 결과가 없습니다.</h2>';
                return;
            }

            actors.forEach(actor => {
                const profileUrl = actor.profile_path 
                    ? `https://image.tmdb.org/t/p/w500${actor.profile_path}`
                    : '/static/no_image.png'; // 이미지가 없을 경우를 위한 기본 이미지

                const card = `
                    <a href="/actor/${actor.id}" class="actor-card-link">
                        <div class="actor-card">
                            <img src="${profileUrl}" alt="${actor.name}">
                            <div class="actor-info">
                                <h3>${actor.name}</h3>
                                <p>${actor.known_for_department || ''}</p>
                            </div>
                        </div>
                    </a>
                `;
                resultsContainer.insertAdjacentHTML('beforeend', card);
            });
        }
    </script>
</body>
</html>